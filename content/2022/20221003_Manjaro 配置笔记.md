---
title: Manjaro 配置笔记
slug: 20221003-manjaro-配置笔记
datetime: 2022-10-03 00:00
date: 2022-10-03 00:00
summary: Manjaro Linux 系统配置和优化笔记，包括常用软件安装、系统设置和性能优化等内容。

tags: manjaro, config
cover_image_url: 
---
### 配置源
首先更换国内源，选延迟最低的那一个
    
    sudo pacman -S yay  
    sudo pacman-mirrors -i -c China -m rank
    sudo pacman -Syyu

然后添加archlinuxcn仓库，因为稍后声笔自然的安装包需要从里面下载，在末尾添加

    sudo gedit /etc/pacman.conf

						  
    [archlinuxcn]
    SigLevel = Optional TrustedOnly
    Server = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch

### archlinuxcn-keyring
    sudo pacman -Syyu
    yay -S archlinuxcn-keyring

### 中文相关
    yay -S ttf-ms-fonts
    yay -S ttf-consolas-with-yahei

### 笔记本电脑推荐安装tlp电源管理
    yay -S tlp tlp-rdw
    sudo tlp start  # 启动服务
    sudo systemctl enable fstrim.timer  # TRM会帮助清理SSD中的块，从而延长SSD的使用寿命

### themes
    yay -S yaru-colors-gtk-theme-git

### app
    yay -S copyq    # /usr/bin/copyq show
    yay -S freerdp
    yay -S freefilesync-bin
    yay -S tencent-docs-bin
    yay -S flameshot    # 火焰截图，#flameshot gui -c   
    yay -S filezilla
    yay -S dbeaver
    yay -S winscp
    yay -S nutstore     # 坚果云
    yay -S python-gobject       # 坚果云依赖
    
    yay -S visual-studio-code-bin
    yay -S google-chrome
    yay -S microsoft-edge-stable-bin
    yay -S microsoft-edge-dev-binv
    yay -S keepassxc
    yay -S utools
    
    yay -S git
    yay -S fzf
    yay -S fd

    yay -S redshift-minimal     # 时移
    yay -S neofetch
    yay -S netease-cloud-music-gtk4

    yay -S  font-manager # 字体管理器
    yay -S ventoy-bin   # U盘启动镜像
    yay -S konsole  # KDE 应用
    yay -S dolphin  # KDE 应用
    yay -S stacer   # 磁盘清理：stacer功能比较多
    yay -S bleachbit    # 磁盘清理

    conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free
    conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
    conda config --set show_channel_urls yes
    source /opt/miniconda3/bin/activate root
    gnome-screenshot -f /home/cheyan/Downloads/screenshot_$(date +%Y%m%d_%H%M%S).png


### flatpak 应用
    flatpak install flathub io.dbeaver.DBeaverCommunity
    flatpak install com.tencent.wemeet
    flatpak install org.freefilesync.FreeFileSync
    flatpak install org.keepassxc.KeePassXC
    flatpak install com.discordapp.Discord
    
    flatpak install com.github.hluk.copyq
    # /usr/bin/flatpak run --branch=stable --arch=x86_64 --command=copyq com.github.hluk.copyq --start-server show

#### flatpak wine
    flatpak --user remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo
    flatpak --user -y install flathub org.winehq.Wine/x86_64/stable-22.08
    flatpak -y remove io.github.fastrizwaan.WineZGUI
    wget -c https://github.com/fastrizwaan/flatpak-wine/releases/download/0.97.12/flatpak-winezgui_0.97.12_20230522.flatpak
    flatpak --user install flatpak-winezgui_0.97.12_20230522.flatpak
    flatpak run io.github.fastrizwaan.WineZGUI

#### 启动
    flatpak run io.github.fastrizwaan.WineZGUI

#### 配置前缀
    WINEPREFIX=/home/cheyan/.var/app/io.github.fastrizwaan.WineZGUI/data/winezgui/Prefixes/navicat162_premium_en_x86 flatpak run --command=wine io.github.fastrizwaan.WineZGUI winecfg

#### 前缀运行
    WINEPREFIX=/home/cheyan/.var/app/io.github.fastrizwaan.WineZGUI/data/winezgui/Prefixes/navicat162_premium_en_x86 flatpak run --command=wine io.github.fastrizwaan.WineZGUI "/home/cheyan/.var/app/io.github.fastrizwaan.WineZGUI/data/winezgui/Prefixes/navicat162_premium_en_x86/drive_c/Program Files (x86)/PremiumSoft/Navicat Premium 16/navicat.exe"

### 卸载自带软件
    yay -R parcellite
    yay -R vivaldi
    yay -R collision

### wechat
    yay -S com.qq.weixin.deepin
    yay -S linuxqq
    sudo pacman -S wmctrl xdotool


###  wps
    yay -S wps-office-cn
    yay -S wps-office-mui-zh-cn
    yay -S libtiff5
    yay -S ttf-wps-fonts

### btrfs
    yay -S grub-btrfs
    sudo grub-mkconfig -o /boot/grub/grub.cfg

### BTRFS with timeshift snapshots on the grub menu
    yay -S timeshift
    yay -S timeshift-autosnap
    yay -S inotify-tools
    sudo systemctl enable --now cronie.service
    yay -S grub-btrfs
    sudo systemctl edit --full grub-btrfsd
    sudo systemctl enable --now grub-btrfsd
    sudo systemctl start grub-btrfsd

### fcitx5
    yay -S base-devel
    yay -S google-glog
    yay -S lib32-udis86-git
    yay -S autoconf automake libtool
    yay -S fcitx5 fcitx5-configtool fcitx5-qt fcitx5-gtk fcitx5-chinese-addons fcitx5-material-color fcitx5-rime fcitx5-configtool fcitx5-gtk fcitx5-qt
    yay -S boost capnproto glog leveldb librime-data lua51 marisa opencc yaml-cpp cmake git gtest ninja wget gcc
    yay -S cmake
    yay -S boost
    yay -S gtest
    sudo pacman -S yaml-cpp
    sudo pacman -S leveldb

### librime
    git clone --branch 9.5.10 https://github.com/sbxlmdsl/librime
    cd librime
    make    # 编译器
    sudo make install   # 安装
    
    # 修改输入法环境变量
    
    gedit ~/.pam_environment
    GTK_IM_MODULE DEFAULT=fcitx
    QT_IM_MODULE  DEFAULT=fcitx
    XMODIFIERS    DEFAULT=@im=fcitx
    
    gedit ~/.xprofile
    export GTK_IM_MODULE=fcitx
    export QT_IM_MODULE=fcitx
    export XMODIFIERS=@im=fcitx
    export QT_IM_MODULE=fcitx
    fcitx5 &

### system tools
    yay -S fish
    yay -S zsh
    yay -S timeshift
    yay -S ttf-sarasa-gothic # 更纱黑体
    yay -S fsearch
    yay -S wine winetricks wine-mono wine_gecko

### v2raya
    
    [archlinuxcn]   # 添加archlinuxcn仓库
    SigLevel = Never
    Server = https://mirrors.bfsu.edu.cn/archlinuxcn/$arch


    sudo pacman -Sy xray v2raya # 安装v2rayA与xray-core
    systemctl enable v2raya --now   # 启动v2rayA服务

    sudo systemctl start v2raya.service
    sudo systemctl enable v2raya.service    # 127.0.0.1:2017
    # 将“全局透明代理”和“规则端口的分流模式”都设置为G*WList，其他设置默认，点击保存并应用


### other
    yay -S xdotool
    yay -S durian-ocr 
    yay -S esearch-electron-bin  
    yay -S playonlinux  # 选择2 openbsd-netcat 

### app
    yay -S electronic-wechat-uos-bin
    yay -S com.qq.weixin.deepin # https://aur.archlinux.org/packages/deepin-wine-wechat
    
    yay -S com.qq.weixin.spark
    yay -S deepin-wine-wechat

`~/.deepinwine/Spark-weixin/scale.txt` 内可用的缩放选项为： `1.0，1.25，1.5，1.75，2.0`  
在4k分辨率下2.0依然很小

    sudo gedit /opt/durapps/spark-dwine-helper/scale-set-helper/set-wine-scale.sh

    case "$wine_scale" in
    1.0)
    dpi="96"
    ;;
    1.25)
    dpi="120"
    ;;
    1.5)
    dpi="144"
    ;;
    1.75)
    dpi="192"
    ;;
    2.0)
    dpi="240"
    ;;
    *)
    dpi="96"
    #可能不是Xorg或者是其他错误
    ;;
    esac

    rm -rf ~/.deepinwine/Deepin-WeChat


### 安装deepin微信
    /opt/apps/com.qq.weixin.deepin/files/run.sh
    DEEPIN_WINE_SCALE=2.5 /opt/apps/com.qq.weixin.deepin/files/run.sh -u %u

    WINEPREFIX=~/.deepinwine/Deepin-WeChat deepin-wine6-stable winecfg  # 修改缩放

### rofi

    /home/cheyan/APP/rofi/build/rofi -show

    yay -S rofi
    yay -S rofi-greenclip
    yay -S rofi-power-menu
    yay -S rofi-theme-android-1080p
    yay -S rofi-theme-android-720p
    yay -S rofi-theme-applet-1080p
    yay -S rofi-theme-applet-720p
    yay -S rofi-theme-fonts
    yay -S rofi-theme-launcher-1080p
    yay -S rofi-theme-launcher-720p
    yay -S rofi-theme-menu-1080p
    yay -S rofi-theme-menu-720p
    yay -S rofi-theme-powermenu-1080p
    yay -S rofi-theme-powermenu-720p
    yay -S rofi-theme-used

### android
    yay -S qtscrcpy


### touchegg
    yay -S touchegg
    sudo systemctl start touchegg
    sudo systemctl enable touchegg

### kvm
    yay -S qemu virt-manager virt-viewer dnsmasq vde2 bridge-utils openbsd-netcat dmidecode
    yay -S ebtables iptables
    yay -S libguestfs
    yay -S xorg-server xorg-xinit

    sudo groupadd libvirt
    sudo systemctl enable --now libvirtd
    sudo usermod -aG libvirt $USER
    sudo usermod -aG kvm $USER

##### 开机自动启动虚拟机网络
    sudo virsh net-autostart default

##### 开机自动启动虚拟机
    sudo virsh list --all

    Id   Name    State
    -----------------------
    1    RDPWindows   running

    sudo virsh autostart RDPWindows  # 自动启动
    sudo virsh autostart --disable RDPWindows    # 禁用自动启动

##### 在用户模式下运行 KVM
    sudo sed -i "s/#user = "root"/user = "$(id -un)"/g" /etc/libvirt/qemu.conf
    sudo sed -i "s/#group = "root"/group = "$(id -gn)"/g" /etc/libvirt/qemu.conf
    sudo usermod -a -G kvm $(id -un)
    sudo usermod -a -G libvirt $(id -un)
    sudo systemctl restart libvirtd
    sudo ln -s /etc/apparmor.d/usr.sbin.libvirtd /etc/apparmor.d/disable/

### tuxedo
    yay -S --needed git base-devel
    yay -S linux-headers
    yay -S tuxedo-keyboard-ite-dkms tuxedo-keyboard-dkms tuxedo-control-center-bin


